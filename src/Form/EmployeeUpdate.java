/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Form;

import Classes.Employee;
import DataBase.Go;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import tourism.company.Tools;

/**
 *
 * @author mohamed
 */
public class EmployeeUpdate extends javax.swing.JFrame {

    /**
     * Creates new form EmployeeUpdate
     */
    public EmployeeUpdate() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        EmpTable = new javax.swing.JTable();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        TXTName = new controls.JTextBox(160);
        BTNSearch = new controls.JMybotton();
        TXTCode = new controls.JTextBox(260);
        jLabel4 = new javax.swing.JLabel();
        TXTSSN = new controls.JTextBox(160);
        jLabel5 = new javax.swing.JLabel();
        TXTTele = new controls.JTextBox(160);
        jLabel6 = new javax.swing.JLabel();
        TXTAddress = new controls.JTextBox(160);
        jLabel7 = new javax.swing.JLabel();
        TXTSM = new controls.JTextBox(160);
        jLabel8 = new javax.swing.JLabel();
        TXTSalary = new controls.JTextBox(160);
        jLabel9 = new javax.swing.JLabel();
        TXTJD = new controls.JTextBox(160);
        jLabel10 = new javax.swing.JLabel();
        TXTUser = new controls.JTextBox(160);
        jLabel11 = new javax.swing.JLabel();
        TXTPass = new controls.JPasswordBox(160);
        jLabel12 = new javax.swing.JLabel();
        TXTConfirm = new controls.JPasswordBox(160);
        jLabel13 = new javax.swing.JLabel();
        TXTAge = new controls.JTextBox(160);
        LBLImage = new javax.swing.JLabel();
        BTNChooce = new controls.JMybotton();
        BTNUpdate = new controls.JMybotton();
        BTNDelete = new controls.JMybotton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        jPanel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 153)));
        jPanel1.setLayout(null);

        EmpTable.setFont(new java.awt.Font("Dialog", 1, 12)); // NOI18N
        EmpTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "الأسم", "الرقم القومى", "رقم التليفون", "العنوان", "الحالة الأجتماعية", "المرتب", "الوظيفة", "اسم المستخدم", "كلمة المرور", "العمر", "الصورة"
            }
        ));
        jScrollPane1.setViewportView(EmpTable);

        jPanel1.add(jScrollPane1);
        jScrollPane1.setBounds(20, 70, 740, 100);

        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel1.setText("تعديل بيانات الموظف");
        jPanel1.add(jLabel1);
        jLabel1.setBounds(621, 10, 130, 15);

        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setText("الأسم");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(710, 190, 40, 15);

        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel3.setText("كود الموظف");
        jPanel1.add(jLabel3);
        jLabel3.setBounds(540, 40, 80, 15);

        TXTName.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jPanel1.add(TXTName);
        TXTName.setBounds(550, 190, 160, 19);

        BTNSearch.setText("ابحث عن الموظف");
        BTNSearch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BTNSearchActionPerformed(evt);
            }
        });
        jPanel1.add(BTNSearch);
        BTNSearch.setBounds(120, 40, 150, 25);

        TXTCode.setFont(new java.awt.Font("Dialog", 1, 12)); // NOI18N
        TXTCode.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        TXTCode.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                TXTCodeActionPerformed(evt);
            }
        });
        jPanel1.add(TXTCode);
        TXTCode.setBounds(280, 40, 260, 19);

        jLabel4.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel4.setText("الرقم القومى");
        jPanel1.add(jLabel4);
        jLabel4.setBounds(450, 190, 90, 15);

        TXTSSN.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jPanel1.add(TXTSSN);
        TXTSSN.setBounds(290, 190, 160, 19);

        jLabel5.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel5.setText("رقم التليفون");
        jPanel1.add(jLabel5);
        jLabel5.setBounds(670, 250, 90, 15);

        TXTTele.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jPanel1.add(TXTTele);
        TXTTele.setBounds(510, 250, 160, 19);

        jLabel6.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel6.setText("العنوان");
        jPanel1.add(jLabel6);
        jLabel6.setBounds(700, 220, 50, 15);

        TXTAddress.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jPanel1.add(TXTAddress);
        TXTAddress.setBounds(540, 220, 160, 19);

        jLabel7.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel7.setText("الحالة الإجتامعية");
        jPanel1.add(jLabel7);
        jLabel7.setBounds(430, 220, 100, 15);

        TXTSM.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jPanel1.add(TXTSM);
        TXTSM.setBounds(270, 220, 160, 19);

        jLabel8.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel8.setText("المرتب");
        jPanel1.add(jLabel8);
        jLabel8.setBounds(450, 250, 50, 15);

        TXTSalary.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jPanel1.add(TXTSalary);
        TXTSalary.setBounds(290, 250, 160, 19);

        jLabel9.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel9.setText("الوظيفة");
        jPanel1.add(jLabel9);
        jLabel9.setBounds(700, 280, 50, 15);

        TXTJD.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jPanel1.add(TXTJD);
        TXTJD.setBounds(540, 280, 160, 19);

        jLabel10.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel10.setText("اسم المستخدم");
        jPanel1.add(jLabel10);
        jLabel10.setBounds(430, 280, 100, 15);

        TXTUser.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jPanel1.add(TXTUser);
        TXTUser.setBounds(270, 280, 160, 19);

        jLabel11.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel11.setText("كلمة المرور");
        jPanel1.add(jLabel11);
        jLabel11.setBounds(690, 310, 80, 15);
        jPanel1.add(TXTPass);
        TXTPass.setBounds(530, 310, 160, 19);

        jLabel12.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel12.setText("تأكيد كلمة المرور");
        jPanel1.add(jLabel12);
        jLabel12.setBounds(410, 310, 110, 15);
        jPanel1.add(TXTConfirm);
        TXTConfirm.setBounds(250, 310, 160, 19);

        jLabel13.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel13.setText("العمر");
        jPanel1.add(jLabel13);
        jLabel13.setBounds(710, 340, 40, 15);

        TXTAge.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jPanel1.add(TXTAge);
        TXTAge.setBounds(540, 340, 160, 19);

        LBLImage.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 2));
        jPanel1.add(LBLImage);
        LBLImage.setBounds(40, 190, 150, 120);

        BTNChooce.setText("أرفع الصورة الجديدة");
        BTNChooce.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BTNChooceActionPerformed(evt);
            }
        });
        jPanel1.add(BTNChooce);
        BTNChooce.setBounds(30, 320, 160, 25);

        BTNUpdate.setText("تحديث البيانات");
        BTNUpdate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BTNUpdateActionPerformed(evt);
            }
        });
        jPanel1.add(BTNUpdate);
        BTNUpdate.setBounds(377, 360, 123, 25);

        BTNDelete.setText("مسح البيانات");
        BTNDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BTNDeleteActionPerformed(evt);
            }
        });
        jPanel1.add(BTNDelete);
        BTNDelete.setBounds(240, 360, 112, 25);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 783, Short.MAX_VALUE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 402, Short.MAX_VALUE)
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents
    DefaultTableModel Model;
    
    private void setModel ()
    {
        Model = (DefaultTableModel) EmpTable.getModel();
    }
    
    private void getData ()
    {
        if (TXTCode.getText().equals(""))
        {
            Tools.myMess("من فضلك ادخل كود الموظف");
        }
        else
        {
            int id = Integer.parseInt(TXTCode.getText());
            Employee em = new Employee();
            em.setId(id);
            if (em.quary())
            {
                em.getOneRow(EmpTable, "Employee", 0, 8);
                
                setModel();
                TXTName.setText(Model.getValueAt(0, 0).toString());
                TXTSSN.setText(Model.getValueAt(0, 1).toString());
                TXTTele.setText(Model.getValueAt(0, 2).toString());
                TXTAddress.setText(Model.getValueAt(0, 3).toString());
                TXTSM.setText(Model.getValueAt(0, 4).toString());
                TXTSalary.setText(Model.getValueAt(0, 5).toString());
                TXTJD.setText(Model.getValueAt(0, 6).toString());
                TXTUser.setText(Model.getValueAt(0, 7).toString());
                TXTPass.setText(Model.getValueAt(0, 8).toString());
                TXTConfirm.setText(Model.getValueAt(0, 8).toString());
                TXTAge.setText(Model.getValueAt(0, 9).toString());
                Tools.setIcon(Model.getValueAt(0, 10).toString(), LBLImage, 150, 120);
                
            }
            else
                Tools.myMess("معزرة لم نجد الموظف التى تريد ان تجد بياناته");
        }
    }
    
    private void BTNSearchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BTNSearchActionPerformed
        getData();
    }//GEN-LAST:event_BTNSearchActionPerformed

    private String URL;
    private void BTNUpdateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BTNUpdateActionPerformed
        if (!TXTPass.getText().equals(TXTConfirm.getText()))
        {
            Tools.myMess("كلمة المررور الجديدية غير متطابقة");
            TXTPass.setText("");
            TXTConfirm.setText("");
            TXTPass.requestFocus();
        }
        else
        {
            try {
                Integer.parseInt(TXTTele.getText());
                if (TXTTele.getText().length() != 11)
                {
                    Tools.myMess("اكتب رقم التليفون الجديد مكون من ثلاثة عشر رقم");
                    TXTTele.setText("");
                    TXTTele.requestFocus();
                }    
                else
                {
                    // i made default the link of photo will be take from the table
                    setModel();
                    URL = Model.getValueAt(0,10).toString();
                    URL = URL.replace("\\", "\\\\");
                    String Photo = URL;
                    
                    // Send Data To the Class to update it
                    Employee em = new Employee();
                    em.setId(Integer.parseInt(TXTCode.getText()));
                    em.setName(TXTName.getText());
                    em.setSSN(Long.parseLong(TXTSSN.getText()));
                    em.setAdress(TXTAddress.getText());
                    em.setSM(TXTSM.getText());
                    em.setTele(TXTTele.getText());
                    em.setSalary(Integer.parseInt(TXTSalary.getText()));
                    em.setJD(TXTJD.getText());
                    em.setUserName(TXTUser.getText());
                    em.setNew_Pass(TXTPass.getText());
                    em.setPhoto(Photo);
                    em.setAge(Integer.parseInt(TXTAge.getText()));
                    
                    // update in database
                    em.update();
                    
                    // print data in the screen from database
                    getData();
                    
                }
            } catch(NumberFormatException ex) {
                Tools.myMess("اكتب رقم التليفون صالح");
                TXTTele.setText("");
                TXTTele.requestFocus();
            }
            
        }
    }//GEN-LAST:event_BTNUpdateActionPerformed

    private void TXTCodeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_TXTCodeActionPerformed
        getData();
    }//GEN-LAST:event_TXTCodeActionPerformed

    private void BTNChooceActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BTNChooceActionPerformed
        URL = Tools.GetAnyPhoto(BTNChooce, LBLImage, 150, 120);
        
        /* put the new link from JChooser to the table and
           i will take it to put it in databse
        */
        setModel();
        Model.setValueAt(URL, 0, 10);
    }//GEN-LAST:event_BTNChooceActionPerformed

    private void BTNDeleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BTNDeleteActionPerformed
        int x = JOptionPane.showConfirmDialog(null, "هل تريد مسح البيانات؟", "مسح", JOptionPane.YES_NO_OPTION);
        if (x == 0)
        {
            Employee em = new Employee();
            em.setId(Integer.parseInt(TXTCode.getText()));
            em.delete();
            em.getAllRow(EmpTable, "Employee", 0, 0);
            
            TXTCode.setText("");
            TXTName.setText("");
            TXTSSN.setText("");
            TXTAddress.setText("");
            TXTSM.setText("");
            TXTTele.setText("");
            TXTSalary.setText("");
            TXTJD.setText("");
            TXTUser.setText("");
            TXTPass.setText("");
            TXTConfirm.setText("");
            LBLImage.setIcon(null);
            TXTAge.setText("");
        }
    }//GEN-LAST:event_BTNDeleteActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(EmployeeUpdate.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(EmployeeUpdate.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(EmployeeUpdate.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(EmployeeUpdate.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new EmployeeUpdate().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private controls.JMybotton BTNChooce;
    private controls.JMybotton BTNDelete;
    private controls.JMybotton BTNSearch;
    private controls.JMybotton BTNUpdate;
    private javax.swing.JTable EmpTable;
    private javax.swing.JLabel LBLImage;
    private javax.swing.JTextField TXTAddress;
    private javax.swing.JTextField TXTAge;
    private javax.swing.JTextField TXTCode;
    private javax.swing.JPasswordField TXTConfirm;
    private javax.swing.JTextField TXTJD;
    private javax.swing.JTextField TXTName;
    private javax.swing.JPasswordField TXTPass;
    private javax.swing.JTextField TXTSM;
    private javax.swing.JTextField TXTSSN;
    private javax.swing.JTextField TXTSalary;
    private javax.swing.JTextField TXTTele;
    private javax.swing.JTextField TXTUser;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    // End of variables declaration//GEN-END:variables
}
